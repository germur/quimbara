---
import { getCollection } from 'astro:content'

import PageLayout from '@/layouts/BaseLayout.astro'
import Breadcrumbs from '@/components/Breadcrumbs.astro'

export const prerender = true

const allPosts = await getCollection('blog')
const trainingPosts = allPosts
  .sort((a, b) => b.data.publishDate.valueOf() - a.data.publishDate.valueOf())
  .filter((post) =>
    post.data.tags?.some((tag) =>
      ['entrenamiento', 'tecnica', 'tutorial', 'guia'].includes(tag.toLowerCase())
    )
  )

const categories = [
  {
    title: 'Striking',
    description: 'Boxeo, Muay Thai, Kickboxing y Karate para MMA.',
    icon: 'ü•ä',
    slug: 'striking'
  },
  {
    title: 'Grappling',
    description: 'Jiu-Jitsu Brasile√±o, Wrestling, Judo y Sambo.',
    icon: 'ü§º',
    slug: 'grappling'
  },
  {
    title: 'Acondicionamiento',
    description: 'Fuerza, cardio, nutrici√≥n y recuperaci√≥n.',
    icon: 'üí™',
    slug: 'acondicionamiento'
  },
  {
    title: 'Estrategia',
    description: 'Gameplans, an√°lisis de oponentes y psicolog√≠a.',
    icon: 'üß†',
    slug: 'estrategia'
  }
]

const meta = {
  title: 'Entrenamiento de MMA y T√©cnicas de Combate | Quimbara',
  description:
    'Aprende artes marciales mixtas. Gu√≠as de entrenamiento, tutoriales de t√©cnicas, rutinas de acondicionamiento y consejos de expertos.'
}
---

<PageLayout {meta}>
  <Breadcrumbs
    path={[
      { title: 'Inicio', link: '/' },
      { title: 'Entrenamiento', link: '/tecnicas-entrenamientos/' }
    ]}
  />

  <section class='py-12'>
    <div class='text-center max-w-4xl mx-auto mb-16'>
      <h1 class='text-5xl md:text-7xl font-heading font-bold text-[#E83C91] mb-6'>
        ACADEMIA <span class='text-[#E83C91]'>QUIMBARA</span>
      </h1>
      <p class='text-xl text-[#43334C] 300'>
        Tu recurso definitivo para el aprendizaje de Artes Marciales Mixtas. Desde los fundamentos
        hasta las t√©cnicas de campeonato.
      </p>
    </div>

    <!-- Categories Grid -->
    <div class='grid md:grid-cols-2 lg:grid-cols-4 gap-6 mb-20'>
      {
        categories.map((cat) => (
          <a
            href={`/blog/category/${cat.slug}`}
            class='glass-panel p-8 rounded-2xl text-center hover:bg-white/5 transition-all group hover:-translate-y-1 duration-300'
          >
            <div class='text-6xl mb-6 group-hover:scale-110 transition-transform duration-300'>
              {cat.icon}
            </div>
            <h2 class='text-2xl font-heading font-bold text-[#E83C91] mb-3'>{cat.title}</h2>
            <p class='text-[#43334C] 400 text-sm'>{cat.description}</p>
          </a>
        ))
      }
    </div>

    <!-- Latest Guides -->
    <div class='mb-12'>
      <div class='flex items-center gap-4 mb-8'>
        <h2 class='text-3xl font-heading font-bold text-[#E83C91]'>√öltimas Gu√≠as</h2>
        <div class='h-px bg-white/10 flex-1'></div>
      </div>

      <div class='grid md:grid-cols-3 gap-8'>
        {
          trainingPosts.length > 0 ? (
            trainingPosts.slice(0, 3).map((post) => (
              <article class='glass-panel rounded-xl overflow-hidden group'>
                <a href={`/blog/${post.id}/`} class='block aspect-video overflow-hidden relative'>
                  {post.data.heroImage ? (
                    <img
                      src={post.data.heroImage.src.src}
                      alt={post.data.heroImage.alt}
                      class='w-full h-full object-cover transition-transform duration-500 group-hover:scale-110'
                    />
                  ) : (
                    <div class='w-full h-full bg-[#43334C]/5' />
                  )}
                  <div class='absolute inset-0 bg-black/40 group-hover:bg-transparent transition-colors' />
                </a>
                <div class='p-6'>
                  <div class='text-xs font-bold text-[#E83C91] uppercase mb-2'>
                    {post.data.tags?.[0]}
                  </div>
                  <h3 class='text-xl font-bold text-[#E83C91] mb-2 group-hover:text-[#E83C91] transition-colors'>
                    <a href={`/blog/${post.id}/`}>{post.data.title}</a>
                  </h3>
                  <p class='text-[#43334C] 400 text-sm line-clamp-2'>{post.data.description}</p>
                </div>
              </article>
            ))
          ) : (
            <div class='col-span-3 text-center py-12 glass-panel rounded-xl'>
              <p class='text-[#43334C] 400'>Pronto publicaremos nuevas gu√≠as de entrenamiento.</p>
            </div>
          )
        }
      </div>
    </div>
  </section>
</PageLayout>
